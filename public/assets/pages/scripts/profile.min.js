var Profile=function(){return{init:function(){Profile.initMiniCharts()},initMiniCharts:function(){App.isIE8()&&!Function.prototype.bind&&(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var i=Array.prototype.slice.call(arguments,1),r=this,n=function(){},o=function(){return r.apply(this instanceof n&&t?this:t,i.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o}),$("#sparkline_bar").sparkline([8,9,10,11,10,10,12,10,10,11,9,12,11],{type:"bar",width:"100",barWidth:6,height:"45",barColor:"#F36A5B",negBarColor:"#e02222"}),$("#sparkline_bar2").sparkline([9,11,12,13,12,13,10,14,13,11,11,12,11],{type:"bar",width:"100",barWidth:6,height:"45",barColor:"#5C9BD1",negBarColor:"#e02222"})}}}();App.isAngularJsApp()===!1&&jQuery(document).ready(function(){Profile.init()});
var baseUrl = window.location.host;

$("#password_change").submit(function(e) {
    $.ajax({
           	type: "POST",
           	url: "http://"+baseUrl+"/change-pass",
        	//data: data,
        	dataType:"json",
           data: $("#password_change").serialize(), // serializes the form's elements.
           }).success(function(data) {
           		$('#new_password , #password_confirmation , #current_password').parent().removeClass('has-error');
		        $('#new_password , #password_confirmation , #current_password').parent().children('.help-block').html('');
		    	if(data==0){
		        	$('#current_password').parent().addClass('has-error');
		        	$('#current_password').parent().children('.help-block').html('<strong> Your current password didnt match</strong>');
		        }
            else{
              $('#new_password , #password_confirmation , #current_password').parent().removeClass('has-error');
              $('#new_password , #password_confirmation , #current_password').parent().children('.help-block').html('');
              alert("Your password changed Succesfully");
              $("#password_change")[0].reset();
            }
			}).error(function(data) { // the data parameter here is a jqXHR instance
		        $('#new_password , #password_confirmation , #current_password').parent().removeClass('has-error');
		        $('#new_password , #password_confirmation , #current_password').parent().children('.help-block').html('');
		        var errors = $.parseJSON(data.responseText);
		        if(errors['password']){
		        	$('#new_password').parent().addClass('has-error');
		        	$('#new_password').parent().children('.help-block').html('<strong>'+errors['password']+'</strong>');
		        }
		        if(errors['password_confirmation']){
		        	$('#password_confirmation').parent().addClass('has-error');
		        	$('#password_confirmation').parent().children('.help-block').html('<strong>'+errors['password_confirmation']+'</strong>');
		        }
		        // var errors = data.responseText;
		        // console.log(errors[0]);
		    });

    e.preventDefault(); // avoid to execute the actual submit of the form.
});
